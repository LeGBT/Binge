require "rake/clean"

def options
	"-Xlint:-serial,unchecked,deprecation"
end

desc "defaut task"
task :default => ["build_modified"] 
task :build_all => ["build_classes", "build_docs"]

task :build_classes => ["items", "timers","data", "binge"]

task :doc => ["build_docs"] do
	verbose(false){sh %{open index.html}}
end


task :build_modified do
	verbose(false){
		`git status --porcelain | grep -E -o "[^\ ]*java$"`.each_line{|line|  
		puts line
		sh %{javac #{line}}
	}
	}
end


desc "Docs generation..."
task :build_docs  do
	#	puts "Docs generation..."
	verbose(false){	sh %{javadoc fr.legbt.binge -subpackages fr.legbt.binge.items:fr.legbt.binge.timers:fr.legbt.binge.data:fr.legbt.binge.graphics:fr.legbt.binge.ui > doclog.tmp}}
end


desc "fr.legbt.binge.timers package build"
task :timers do
	#	puts "build binge.timers"
	verbose(false) do
		sh %{javac #{options} fr/legbt/binge/timers/*.java}
	end

end

desc "fr.legbt.binge.data package build"
task :data do
	#	puts "build binge.data"
	verbose(false) do
		sh %{javac #{options} fr/legbt/binge/data/*.java}
	end

end

desc "fr.legbt.binge.graphics package build"
task :data do
	#	puts "build binge.graphics"
	verbose(false) do
		sh %{javac #{options} fr/legbt/binge/graphics/*.java}
	end

end

desc "fr.legbt.binge main package build"
task :binge do
	#	puts "build binge main classes"
	verbose(false) do
		sh %{javac #{options} fr/legbt/binge/*.java}
	end
end

desc "fr.legbt.items package build"
task :items do
	#	puts "build binge.items ..."
	verbose(false) do
		sh %{javac #{options} fr/legbt/binge/items/*.java}
	end
end

desc "les exemples"
task :ex do
	#	puts "examples builds"
	verbose(false) do
		sh %{javac #{options} examples/*/*.java}
	end
end

CLEAN.include(".DS_Store","*.tmp")
CLOBBER.include("**/*.class", "**/*.css", "**/.DS_Store", "**/*.html","*.tmp")
